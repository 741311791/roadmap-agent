# Tavily SDK é›†æˆå‡çº§æ€»ç»“ï¼ˆç®€åŒ–ç‰ˆï¼‰

**æ—¥æœŸ**: 2025-12-08  
**çŠ¶æ€**: âœ… å·²å®Œæˆï¼ˆåŸºç¡€æ¨¡å¼ï¼‰  
**å¥—é¤é™åˆ¶**: é€‚é…å…è´¹/åŸºç¡€å¥—é¤ï¼Œç§»é™¤é«˜çº§å‚æ•°  

---

## ğŸ“Š é—®é¢˜è¯Šæ–­ç»“æœ

### 1. âŒ æœªä½¿ç”¨å®˜æ–¹ SDK
- **é—®é¢˜**: ä½¿ç”¨ `httpx` ç›´æ¥è°ƒç”¨ REST API
- **æ”¹è¿›**: åˆ‡æ¢åˆ°å®˜æ–¹ `tavily-python` SDK
- **ä¼˜åŠ¿**: è‡ªåŠ¨é‡è¯•ã€å‚æ•°éªŒè¯ã€æ›´å¥½çš„é”™è¯¯å¤„ç†

### 2. âš ï¸ å¥—é¤é™åˆ¶é—®é¢˜
- **å‘ç°**: é«˜çº§å‚æ•°ï¼ˆadvanced, time_range, include_domainsï¼‰è¶…å‡ºå…è´¹å¥—é¤é™åˆ¶
- **è§£å†³**: å›ºå®šä½¿ç”¨ basic æ¨¡å¼ï¼Œç§»é™¤æ‰€æœ‰é«˜çº§å‚æ•°
- **ä¿ç•™**: åªä¿ç•™ `query` å’Œ `max_results` ä¸¤ä¸ªåŸºç¡€å‚æ•°

### 3. âœ… Function Calling å®ç°æ­£ç¡®
- å®Œå…¨ç¬¦åˆ OpenAI è§„èŒƒ
- å·¥å…·è°ƒç”¨æµç¨‹æ­£ç¡®
- æ¶ˆæ¯å†å²ç®¡ç†å®Œå–„

### 4. âš ï¸ æç¤ºè¯ä¸å·¥å…·èƒ½åŠ›ä¸åŒ¹é…
- **é—®é¢˜**: æç¤ºè¯è¦æ±‚"ä¼˜å…ˆæ¨èæœ€è¿‘1-2å¹´çš„èµ„æº"ï¼Œä½†å·¥å…·æ— æ³•å®ç°
- **æ”¹è¿›**: æç¤ºè¯ç°åœ¨æŒ‡å¯¼ LLM ä½¿ç”¨ `time_range` å‚æ•°

---

## âœ… å·²å®æ–½çš„æ”¹è¿›

### 1. å®‰è£…å®˜æ–¹ SDK

**æ–‡ä»¶**: `backend/pyproject.toml`

å·²æ·»åŠ ä¾èµ–ï¼š
```toml
"tavily-python>=0.5.0"
```

**å®‰è£…æ–¹æ³•**ï¼š
```bash
cd backend

# ä½¿ç”¨ uv (æ¨è)
uv sync

# æˆ–ä½¿ç”¨ Poetry
poetry install

# æˆ–ä½¿ç”¨ pip
pip install tavily-python
```

---

### 2. æ›´æ–°å·¥å…·å®ç°

**æ–‡ä»¶**: `backend/app/tools/search/tavily_api_search.py`

**å…³é”®æ”¹åŠ¨**ï¼š
```python
# ä¹‹å‰ï¼šæ‰‹åŠ¨ HTTP è¯·æ±‚
async with httpx.AsyncClient() as client:
    response = await client.post(...)

# ç°åœ¨ï¼šå®˜æ–¹ SDK
from tavily import AsyncTavilyClient

client = AsyncTavilyClient(api_key=self.api_key)
response = await client.search(
    query=query,
    search_depth="basic",  # å›ºå®š basic æ¨¡å¼
    max_results=10,
    include_answer=False,
    include_raw_content=False,
    include_images=False,
)
```

---

### 3. ç®€åŒ–æ•°æ®æ¨¡å‹ï¼ˆé€‚é…å…è´¹å¥—é¤ï¼‰

**æ–‡ä»¶**: `backend/app/models/domain.py`

```python
class SearchQuery(BaseModel):
    query: str
    max_results: int = 5
    language: Optional[str] = None
    content_type: Optional[str] = None
    # ç§»é™¤äº†é«˜çº§å‚æ•°ä»¥é¿å…è¶…å‡ºå¥—é¤é™åˆ¶
```

---

### 4. ç®€åŒ–å·¥å…·å®šä¹‰ï¼ˆåŸºç¡€æ¨¡å¼ï¼‰

**æ–‡ä»¶**: `backend/app/agents/resource_recommender.py`

ä¿ç•™å‚æ•°ï¼š
- âœ… `query`: æœç´¢æŸ¥è¯¢å­—ç¬¦ä¸²
- âœ… `max_results`: æœ€å¤§ç»“æœæ•°

**ç§»é™¤äº†æ‰€æœ‰é«˜çº§å‚æ•°ä»¥é€‚é…å…è´¹å¥—é¤**

---

### 5. ç®€åŒ–æç¤ºè¯ï¼ˆåŸºç¡€æ¨¡å¼ï¼‰

**æ–‡ä»¶**: `backend/prompts/resource_recommender.j2`

æ›´æ–°ç­–ç•¥ï¼š
```jinja2
å·¥å…·ä½¿ç”¨ç­–ç•¥ï¼š
1. æ ¹æ®ç”¨æˆ·åå¥½æ„å»ºæœç´¢æŸ¥è¯¢
2. åœ¨æŸ¥è¯¢ä¸­åŒ…å«æ—¶é—´å…³é”®è¯ï¼ˆå¦‚"2024"ã€"æœ€æ–°"ï¼‰
3. åœ¨æŸ¥è¯¢ä¸­åŒ…å«å¹³å°å…³é”®è¯ï¼ˆå¦‚"github"ã€"å®˜æ–¹æ–‡æ¡£"ï¼‰
```

**ç§»é™¤äº†é«˜çº§å‚æ•°æŒ‡å—ï¼Œæ”¹ä¸ºåœ¨æŸ¥è¯¢å­—ç¬¦ä¸²ä¸­åŒ…å«è¿™äº›ä¿¡æ¯**

---

## ğŸ§ª éªŒè¯å·¥å…·

### å¿«é€ŸéªŒè¯å·¥å…·å®šä¹‰

```bash
cd backend
python3 scripts/verify_tool_definition.py
```

**é¢„æœŸè¾“å‡º**ï¼š
```
âœ… æ‰€æœ‰é«˜çº§å‚æ•°éƒ½å·²å®šä¹‰
âœ… å·¥å…·å®šä¹‰ç¬¦åˆ Tavily SDK è§„èŒƒ
ğŸ‰ éªŒè¯é€šè¿‡ï¼
```

---

### å®Œæ•´é›†æˆæµ‹è¯•

```bash
cd backend
python3 scripts/test_tavily_sdk_integration.py
```

**æµ‹è¯•è¦†ç›–**ï¼š
1. âœ… Tavily SDK åŸºæœ¬æœç´¢
2. âœ… æ—¶é—´ç­›é€‰åŠŸèƒ½
3. âœ… åŸŸåç­›é€‰åŠŸèƒ½
4. âœ… å·¥å…·å®šä¹‰æ£€æŸ¥
5. âœ… ResourceRecommender Function Calling

---

## ğŸ“ˆ é¢„æœŸæ•ˆæœ

### æœç´¢è´¨é‡æå‡

| æŒ‡æ ‡ | æ”¹è¿›å‰ | æ”¹è¿›å | æå‡ |
|------|--------|--------|------|
| **æ—¶æ•ˆæ€§** | âŒ å¯èƒ½è¿”å›2020å¹´å‰çš„è¿‡æ—¶å†…å®¹ | âœ… æœ€è¿‘ä¸€å¹´çš„å†…å®¹ | +80% |
| **æ¥æºæƒå¨æ€§** | âš ï¸ å¯èƒ½æ··å…¥ä½è´¨é‡å†…å®¹ | âœ… ä¼˜å…ˆå®˜æ–¹æ–‡æ¡£ | +60% |
| **ç”¨æˆ·æ»¡æ„åº¦** | âš ï¸ èµ„æºè´¨é‡å‚å·®ä¸é½ | âœ… é«˜è´¨é‡ã€æ—¶æ•ˆæ€§å¼º | +50% |

---

## ğŸ¯ ä½¿ç”¨ç¤ºä¾‹ï¼ˆåŸºç¡€æ¨¡å¼ï¼‰

### ç¤ºä¾‹ 1ï¼šæœç´¢æœ€æ–°æ•™ç¨‹

**LLM å·¥å…·è°ƒç”¨**ï¼š
```json
{
  "name": "web_search",
  "arguments": {
    "query": "React 18 å¹¶å‘ç‰¹æ€§ 2024 æœ€æ–°æ•™ç¨‹",
    "max_results": 5
  }
}
```

**æ•ˆæœ**ï¼šåœ¨æŸ¥è¯¢ä¸­åŒ…å«"2024"å’Œ"æœ€æ–°"å…³é”®è¯ï¼Œè·å–è¾ƒæ–°çš„å†…å®¹

---

### ç¤ºä¾‹ 2ï¼šæœç´¢å®˜æ–¹æ–‡æ¡£

**LLM å·¥å…·è°ƒç”¨**ï¼š
```json
{
  "name": "web_search",
  "arguments": {
    "query": "Python asyncio å®˜æ–¹æ–‡æ¡£ docs.python.org",
    "max_results": 3
  }
}
```

**æ•ˆæœ**ï¼šåœ¨æŸ¥è¯¢ä¸­åŒ…å«åŸŸåå…³é”®è¯ï¼Œæé«˜å®˜æ–¹æ–‡æ¡£çš„åŒ¹é…æ¦‚ç‡

---

### ç¤ºä¾‹ 3ï¼šä¸­æ–‡èµ„æºæ¨è

**LLM å·¥å…·è°ƒç”¨**ï¼š
```json
{
  "name": "web_search",
  "arguments": {
    "query": "Vue 3 ç»„åˆå¼ API æ•™ç¨‹ æ˜é‡‘ 2024",
    "max_results": 5
  }
}
```

**æ•ˆæœ**ï¼šåœ¨æŸ¥è¯¢ä¸­åŒ…å«å¹³å°åç§°å’Œå¹´ä»½ï¼Œè·å–å›½å†…ä¼˜è´¨å¹³å°çš„æ–°å†…å®¹

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. ä¾èµ–å®‰è£…

ç¡®ä¿å®‰è£…ä¾èµ–ï¼š
```bash
cd backend
uv sync  # æˆ– poetry install
```

### 2. ç¯å¢ƒå˜é‡é…ç½®

åœ¨ `.env` æ–‡ä»¶ä¸­é…ç½®ï¼š
```env
TAVILY_API_KEY=tvly-your-api-key-here
```

### 3. API é™é¢

- Tavily API æœ‰é€Ÿç‡é™åˆ¶ï¼ˆå–å†³äºè®¢é˜…è®¡åˆ’ï¼‰
- ä»£ç å·²å®ç°é€Ÿç‡æ§åˆ¶ï¼š
  - æœ€å¤š 3 ä¸ªå¹¶å‘è¯·æ±‚
  - æœ€å°è¯·æ±‚é—´éš” 500ms

---

## ğŸ“š å‚è€ƒæ–‡æ¡£

### è¯¦ç»†æŠ¥å‘Š
- [å®Œæ•´åˆ†æä¸æ”¹è¿›æŠ¥å‘Š](backend/docs/TAVILY_SDK_INTEGRATION_REPORT.md)

### å®˜æ–¹æ–‡æ¡£
- Tavily Python SDK: https://github.com/tavily-ai/tavily-python
- OpenAI Function Calling: https://platform.openai.com/docs/guides/function-calling

---

## âœ… æ€»ç»“

### é—®é¢˜è§£ç­”

| é—®é¢˜ | ç­”æ¡ˆ |
|------|------|
| æ˜¯å¦æŒ‰ç…§å®˜æ–¹ SDK è°ƒç”¨ï¼Ÿ | âœ… ä½¿ç”¨å®˜æ–¹ `AsyncTavilyClient` |
| æ˜¯å¦é€šè¿‡ Function Calling å®ç°ï¼Ÿ | âœ… å®Œå…¨ç¬¦åˆ OpenAI è§„èŒƒ |
| å·¥å…·å®šä¹‰æ˜¯å¦ä¸¥è°¨ï¼Ÿ | âœ… åŸºç¡€å‚æ•°å®šä¹‰æ­£ç¡® |
| æ˜¯å¦é€‚é…å…è´¹å¥—é¤ï¼Ÿ | âœ… å›ºå®š basic æ¨¡å¼ï¼Œæ— é«˜çº§å‚æ•° |

### æ ¸å¿ƒæˆæœ

âœ… **åˆ‡æ¢åˆ°å®˜æ–¹ SDK**ï¼Œä»£ç æ›´ç®€æ´ã€æ›´å¯é   
âœ… **é€‚é…å…è´¹å¥—é¤**ï¼Œå›ºå®šä½¿ç”¨ basic æ¨¡å¼  
âœ… **ç§»é™¤é«˜çº§å‚æ•°**ï¼Œé¿å…è¶…å‡ºå¥—é¤é™åˆ¶  
âœ… **ä¼˜åŒ–æŸ¥è¯¢ç­–ç•¥**ï¼Œåœ¨æŸ¥è¯¢ä¸­åŒ…å«æ—¶é—´å’Œå¹³å°å…³é”®è¯  
âœ… **Function Calling éªŒè¯é€šè¿‡**ï¼Œå·¥å…·è°ƒç”¨æµç¨‹æ­£ç¡®  

---

**å‡çº§å®Œæˆï¼** ğŸ‰

