"""
å¯è§†åŒ–å¯¹æ¯”ï¼šä¸¤ç§ç«¯ç‚¹çš„æ‰§è¡Œè·¯å¾„å’Œæ•°æ®åº“å†™å…¥æ—¶æœº
"""

print("""
================================================================================
                    è·¯çº¿å›¾ç”Ÿæˆ API æ¶æ„å¯¹æ¯”
================================================================================

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    1. /generate ç«¯ç‚¹ï¼ˆä½¿ç”¨ Checkpointï¼‰                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å®¢æˆ·ç«¯è¯·æ±‚
    â”‚
    â”œâ”€â–º ç«‹å³è¿”å› task_id (HTTP 200)
    â”‚   {"task_id": "xxx", "status": "processing"}
    â”‚
    â”œâ”€â–º åå°ä»»åŠ¡å¼€å§‹æ‰§è¡Œ
    â”‚
    â””â”€â–º LangGraph å·¥ä½œæµ â”€â”€â”€â”€â”€â”
                              â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”œâ”€ [DBå†™å…¥] roadmap_tasks (status=processing)
        â”‚
        â”œâ”€ Intent Analysis
        â”‚   â””â”€ [Checkpoint] ä¿å­˜çŠ¶æ€åˆ° checkpoint_writes
        â”‚
        â”œâ”€ Curriculum Design
        â”‚   â””â”€ [Checkpoint] ä¿å­˜çŠ¶æ€
        â”‚
        â”œâ”€ Structure Validation
        â”‚   â””â”€ [Checkpoint] ä¿å­˜çŠ¶æ€
        â”‚   â†“â†‘ å¯èƒ½å¾ªç¯å¤šæ¬¡
        â”œâ”€ Roadmap Edit
        â”‚   â””â”€ [Checkpoint] ä¿å­˜çŠ¶æ€
        â”‚
        â”œâ”€ Human Review â† â¸ï¸  INTERRUPTï¼ˆå¯èƒ½æš‚åœå‡ å°æ—¶/å‡ å¤©ï¼‰
        â”‚   â”œâ”€ [Checkpoint] ä¿å­˜æš‚åœçŠ¶æ€
        â”‚   â”œâ”€ [DBæ›´æ–°] roadmap_tasks (status=human_review_pending)
        â”‚   â””â”€ ç­‰å¾… /approve ç«¯ç‚¹æ¢å¤...
        â”‚
        â”œâ”€ Tutorial Generationï¼ˆæ¢å¤åæ‰§è¡Œï¼‰
        â”‚   â””â”€ [Checkpoint] ä¿å­˜çŠ¶æ€
        â”‚
        â””â”€ [DBå†™å…¥] roadmap_metadata + tutorial_metadata
            â””â”€ [DBæ›´æ–°] roadmap_tasks (status=completed)

ç‰¹ç‚¹ï¼š
  âœ… æ”¯æŒ Human-in-the-Loop
  âœ… æ”¯æŒæš‚åœ/æ¢å¤
  âœ… æ”¯æŒå¾ªç¯é‡è¯•
  âœ… æ•…éšœæ¢å¤ï¼ˆä» checkpoint æ¢å¤ï¼‰
  âš ï¸  Checkpoint è¡¨ä¼šæŒç»­å†™å…¥ï¼ˆoverheadï¼‰
  âš ï¸  å®¢æˆ·ç«¯éœ€è¦é€šè¿‡ WebSocket/è½®è¯¢æŸ¥è¯¢è¿›åº¦


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  2. /generate-stream ç«¯ç‚¹ï¼ˆæ—  Checkpointï¼‰                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å®¢æˆ·ç«¯è¯·æ±‚
    â”‚
    â””â”€â–º å¼€å§‹æµå¼å“åº”ï¼ˆSSEï¼‰â”€â”€â”€â”€â”€â”€â”
                                 â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”œâ”€ Intent Analyzer.analyze_stream()
        â”‚   â””â”€â–º æµå¼è¾“å‡º â†’ data: {"type":"chunk",...}
        â”‚       æµå¼è¾“å‡º â†’ data: {"type":"chunk",...}
        â”‚       æµå¼è¾“å‡º â†’ data: {"type":"complete",...}
        â”‚
        â”œâ”€ Curriculum Architect.design_stream()
        â”‚   â””â”€â–º æµå¼è¾“å‡º â†’ data: {"type":"chunk",...}
        â”‚       æµå¼è¾“å‡º â†’ data: {"type":"chunk",...}
        â”‚       æµå¼è¾“å‡º â†’ data: {"type":"complete",...}
        â”‚
        â”œâ”€ Tutorial Generator.generate_stream() (å¯é€‰)
        â”‚   â””â”€â–º æµå¼è¾“å‡º â†’ data: {"type":"tutorial_chunk",...}
        â”‚       æµå¼è¾“å‡º â†’ data: {"type":"tutorial_chunk",...}
        â”‚       æµå¼è¾“å‡º â†’ data: {"type":"tutorial_complete",...}
        â”‚
        â””â”€ å®Œæˆåä¸€æ¬¡æ€§å†™å…¥æ•°æ®åº“
            â”œâ”€ [DBå†™å…¥] roadmap_tasks
            â”œâ”€ [DBå†™å…¥] roadmap_metadata
            â””â”€ [DBå†™å…¥] tutorial_metadata (å¦‚æœæœ‰)
            
            â””â”€â–º æµå¼è¾“å‡º â†’ data: {"type":"done", "task_id":"...", ...}

ç‰¹ç‚¹ï¼š
  âœ… å®æ—¶æµå¼åé¦ˆï¼ˆå®¢æˆ·ç«¯å®æ—¶çœ‹åˆ°ç”Ÿæˆè¿‡ç¨‹ï¼‰
  âœ… æ—  checkpoint å¼€é”€ï¼ˆæ›´å¿«ï¼‰
  âœ… æ¶æ„ç®€å•ï¼ˆç›´æ¥è°ƒç”¨ Agentï¼‰
  âœ… ä¸€æ¬¡æ€§å®Œæˆï¼ˆæ— æš‚åœï¼‰
  âŒ ä¸æ”¯æŒ Human-in-the-Loop
  âŒ ä¸æ”¯æŒæš‚åœ/æ¢å¤
  âŒ æ•…éšœæ— æ³•æ¢å¤ï¼ˆéœ€è¦é‡æ–°ç”Ÿæˆï¼‰


================================================================================
                              æ ¸å¿ƒå·®å¼‚
================================================================================

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      ç‰¹æ€§            â”‚   /generate        â”‚  /generate-stream    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ¶æ„                 â”‚ LangGraph çŠ¶æ€æœº   â”‚ ç›´æ¥ Agent è°ƒç”¨      â”‚
â”‚ Checkpoint           â”‚ âœ… ä½¿ç”¨            â”‚ âŒ ä¸ä½¿ç”¨            â”‚
â”‚ æ•°æ®åº“å†™å…¥æ—¶æœº       â”‚ æ¯ä¸ªèŠ‚ç‚¹åå†™å…¥     â”‚ å®Œæˆåä¸€æ¬¡æ€§å†™å…¥     â”‚
â”‚ Human-in-the-Loop    â”‚ âœ… æ”¯æŒ            â”‚ âŒ ä¸æ”¯æŒ            â”‚
â”‚ æš‚åœ/æ¢å¤            â”‚ âœ… æ”¯æŒ            â”‚ âŒ ä¸æ”¯æŒ            â”‚
â”‚ ç»“æ„éªŒè¯             â”‚ âœ… æœ‰              â”‚ âŒ æ—                 â”‚
â”‚ å¾ªç¯é‡è¯•             â”‚ âœ… æ”¯æŒ            â”‚ âŒ ä¸æ”¯æŒ            â”‚
â”‚ å®æ—¶åé¦ˆ             â”‚ WebSocket          â”‚ SSE Stream           â”‚
â”‚ å“åº”æ–¹å¼             â”‚ ç«‹å³è¿”å› task_id   â”‚ æµå¼æŒç»­è¾“å‡º         â”‚
â”‚ æ•…éšœæ¢å¤             â”‚ âœ… å¯ä»checkpoint  â”‚ âŒ éœ€é‡æ–°ç”Ÿæˆ        â”‚
â”‚ æ€§èƒ½                 â”‚ è¾ƒæ…¢ï¼ˆæœ‰overheadï¼‰ â”‚ è¾ƒå¿«                 â”‚
â”‚ é€‚ç”¨åœºæ™¯             â”‚ ç”Ÿäº§ç¯å¢ƒ           â”‚ æ¼”ç¤º/æµ‹è¯•            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


================================================================================
                         ä¸ºä»€ä¹ˆè®¾è®¡ä¸¤ç§ç«¯ç‚¹ï¼Ÿ
================================================================================

1. **ä¸åŒçš„ç”¨æˆ·ä½“éªŒéœ€æ±‚**
   
   ç”Ÿäº§ç¯å¢ƒï¼š
   - ç”¨æˆ·æäº¤è¯·æ±‚åå¯ä»¥ç¦»å¼€
   - å®¡æ ¸äººå‘˜å¯ä»¥ç¨åå®¡æ ¸
   - éœ€è¦å¯é æ€§å’Œå¯è¿½æº¯æ€§
   â†’ ä½¿ç”¨ /generate + Checkpoint

   æ¼”ç¤ºå±•ç¤ºï¼š
   - ç”¨æˆ·å¸Œæœ›å®æ—¶çœ‹åˆ°ç”Ÿæˆè¿‡ç¨‹
   - ä¸éœ€è¦å®¡æ ¸ç¯èŠ‚
   - å¿«é€Ÿè·å¾—ç»“æœ
   â†’ ä½¿ç”¨ /generate-stream


2. **ä¸åŒçš„æŠ€æœ¯æƒè¡¡**
   
   /generate:
   - æ›´å¤šæ•°æ®åº“å†™å…¥ï¼ˆcheckpoint è¡¨ï¼‰
   - æ”¯æŒå¤æ‚çš„çŠ¶æ€ç®¡ç†
   - å¯é æ€§é«˜
   
   /generate-stream:
   - æ›´å°‘æ•°æ®åº“å†™å…¥ï¼ˆåªåœ¨æœ€åä¿å­˜ï¼‰
   - æ¶æ„ç®€å•
   - å“åº”æ›´å¿«


3. **ä¸åŒçš„ä¸šåŠ¡æµç¨‹**
   
   /generate:
   éœ€æ±‚åˆ†æ â†’ æ¡†æ¶è®¾è®¡ â†’ éªŒè¯ â†” ä¿®æ­£ â†’ äººå·¥å®¡æ ¸ â†’ æ•™ç¨‹ç”Ÿæˆ
   
   /generate-stream:
   éœ€æ±‚åˆ†æ â†’ æ¡†æ¶è®¾è®¡ â†’ [å¯é€‰: æ•™ç¨‹ç”Ÿæˆ] â†’ å®Œæˆ


================================================================================
                              æœ€ä½³å®è·µ
================================================================================

æ¨èä½¿ç”¨æ–¹å¼ï¼š

ğŸ¢ **ç”Ÿäº§ç¯å¢ƒ - æ ‡å‡†æµç¨‹**
   POST /api/v1/roadmaps/generate
   â†’ ç­‰å¾…äººå·¥å®¡æ ¸
   â†’ POST /api/v1/roadmaps/{task_id}/approve
   â†’ é€šè¿‡ WebSocket æŸ¥çœ‹è¿›åº¦

ğŸ¯ **æ¼”ç¤ºç¯å¢ƒ - å¿«é€Ÿå±•ç¤º**
   POST /api/v1/roadmaps/generate-stream?include_tutorials=false
   â†’ å®æ—¶æµå¼å±•ç¤ºç”Ÿæˆè¿‡ç¨‹
   â†’ å¿«é€Ÿè·å¾—è·¯çº¿å›¾æ¡†æ¶

ğŸ”¬ **æµ‹è¯•ç¯å¢ƒ - å®Œæ•´éªŒè¯**
   POST /api/v1/roadmaps/generate-full-stream
   â†’ å®æ—¶æµå¼å±•ç¤ºå®Œæ•´è¿‡ç¨‹ï¼ˆå«æ•™ç¨‹ï¼‰
   â†’ éªŒè¯ç«¯åˆ°ç«¯åŠŸèƒ½


================================================================================
                         Checkpoint è¯¦ç»†è¯´æ˜
================================================================================

AsyncPostgresSaver (LangGraph Checkpoint):

ä½œç”¨ï¼š
  1. åœ¨æ¯ä¸ªå·¥ä½œæµèŠ‚ç‚¹å®Œæˆåï¼Œä¿å­˜å½“å‰çŠ¶æ€åˆ°æ•°æ®åº“
  2. æ”¯æŒ interrupt() æš‚åœå·¥ä½œæµ
  3. æ”¯æŒ Command(resume=...) æ¢å¤å·¥ä½œæµ
  4. æ•…éšœæ—¶å¯ä»¥ä»æœ€åä¸€ä¸ª checkpoint æ¢å¤

å­˜å‚¨å†…å®¹ï¼š
  - channel_values: å½“å‰çŠ¶æ€çš„æ‰€æœ‰å­—æ®µ
  - execution_history: æ‰§è¡Œå†å²
  - tutorial_refs: å·²ç”Ÿæˆçš„æ•™ç¨‹å¼•ç”¨
  - ç­‰ç­‰...

å¼€é”€ï¼š
  - æ¯ä¸ªèŠ‚ç‚¹å®Œæˆåå†™å…¥ä¸€æ¬¡
  - åŒ…æ‹¬å¤šä¸ªè¡¨çš„äº‹åŠ¡æ“ä½œ
  - å¯¹æ€§èƒ½æœ‰ä¸€å®šå½±å“

ä¸ºä»€ä¹ˆæµå¼ç«¯ç‚¹ä¸éœ€è¦ï¼š
  - ä¸ä¼šæš‚åœï¼ˆæ—  interruptï¼‰
  - ä¸€æ¬¡æ€§æ‰§è¡Œå®Œæˆ
  - çŠ¶æ€åœ¨å†…å­˜ä¸­å³å¯
  - å®Œæˆåç›´æ¥å†™å…¥æœ€ç»ˆç»“æœ


================================================================================
""")





















