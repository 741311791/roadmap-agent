# å¹¶å‘æ§åˆ¶æœºåˆ¶åˆ†æ

## åˆ†ææ—¶é—´
2025-12-31

## ç”¨æˆ·é—®é¢˜

> æˆ‘è®¾å®šäº† 8 ä¸ª Celery å¹¶å‘ï¼Œä½†å‰ç«¯æ˜¾ç¤ºè¶…è¿‡äº† 8 ä¸ªæ­£åœ¨ç”Ÿæˆï¼Œæ˜¯å› ä¸º Celery æœ‰é¢„å–é€»è¾‘å—ï¼Ÿ

## ç­”æ¡ˆ

**ä¸æ˜¯é¢„å–çš„é—®é¢˜**ï¼Œè€Œæ˜¯å› ä¸ºç³»ç»Ÿé‡‡ç”¨äº†**ä¸¤å±‚å¹¶å‘æ¶æ„**ï¼š

1. **Celery å±‚**ï¼š8 ä¸ªä»»åŠ¡å¹¶å‘ï¼ˆæ§åˆ¶è·¯çº¿å›¾çº§åˆ«ï¼‰
2. **AsyncIO å±‚**ï¼šæ¯ä¸ªè·¯çº¿å›¾å†…éƒ¨æ‰€æœ‰ Concept å¹¶å‘ï¼ˆæ§åˆ¶æ¦‚å¿µçº§åˆ«ï¼‰

å‰ç«¯æ˜¾ç¤ºçš„æ˜¯ **Concept çº§åˆ«**çš„ç”Ÿæˆè¿›åº¦ï¼Œæ‰€ä»¥ä¼šè¶…è¿‡ 8 ä¸ªã€‚

---

## å½“å‰å¹¶å‘æ¶æ„è¯¦è§£

### 1. Celery é…ç½®ï¼ˆcelery_app.pyï¼‰

```python
celery_app.conf.update(
    # é¢„å–é…ç½®ï¼šæ¯ä¸ª worker åªé¢„å– 1 ä¸ªä»»åŠ¡
    worker_prefetch_multiplier=1,
    
    # ä»»åŠ¡è·¯ç”±ï¼šå†…å®¹ç”Ÿæˆä»»åŠ¡è¿›å…¥ä¸“ç”¨é˜Ÿåˆ—
    task_routes={
        "app.tasks.content_generation_tasks.*": {"queue": "content_generation"},
    },
)
```

**å…³é”®ç‚¹**ï¼š
- âœ… `worker_prefetch_multiplier=1` - **æ²¡æœ‰é¢„å–å¤šä½™ä»»åŠ¡**
- âœ… å¯åŠ¨å‘½ä»¤ï¼š`celery worker --concurrency=8` - **æœ€å¤š 8 ä¸ªä»»åŠ¡å¹¶å‘**

### 2. å†…å®¹ç”Ÿæˆä»»åŠ¡æ¶æ„ï¼ˆcontent_generation_tasks.pyï¼‰

```python
@celery_app.task(time_limit=1800, soft_time_limit=1500)
def generate_roadmap_content(task_id, roadmap_id, ...):
    """
    å•ä¸ª Celery ä»»åŠ¡å¤„ç†å•ä¸ªè·¯çº¿å›¾çš„å†…å®¹ç”Ÿæˆ
    """
    # è°ƒç”¨å¼‚æ­¥å‡½æ•°
    return run_async(_async_generate_content(task_id, roadmap_id, ...))


async def _async_generate_content(task_id, roadmap_id, ...):
    """
    å¼‚æ­¥ç”Ÿæˆå•ä¸ªè·¯çº¿å›¾çš„æ‰€æœ‰å†…å®¹
    """
    # æå–æ‰€æœ‰ Conceptï¼ˆå‡è®¾è·¯çº¿å›¾æœ‰ 30 ä¸ª Conceptï¼‰
    concepts = extract_all_concepts(roadmap_framework)
    
    # å¹¶å‘ç”Ÿæˆæ‰€æœ‰ Concept çš„å†…å®¹
    await _generate_content_parallel(
        task_id=task_id,
        roadmap_id=roadmap_id,
        concepts=concepts,  # 30 ä¸ª Concept
        ...
    )


async def _generate_content_parallel(task_id, roadmap_id, concepts, ...):
    """
    å¹¶è¡Œç”Ÿæˆæ‰€æœ‰æ¦‚å¿µçš„å†…å®¹
    """
    # ä¸ºæ¯ä¸ª Concept åˆ›å»ºä¸€ä¸ªåç¨‹
    tasks = [
        generate_single_concept(
            task_id=task_id,
            concept=concept,
            ...
        )
        for concept in concepts  # 30 ä¸ªåç¨‹
    ]
    
    # ğŸ”‘ å…³é”®ï¼šä¸€æ¬¡æ€§å¹¶å‘æ‰€æœ‰ Conceptï¼ˆæ—  Semaphore é™åˆ¶ï¼‰
    await asyncio.gather(*tasks, return_exceptions=True)


async def generate_single_concept(task_id, concept, ...):
    """
    ä¸ºå•ä¸ª Concept ä¸²è¡Œç”Ÿæˆå†…å®¹
    """
    # ä¸²è¡Œæ‰§è¡Œï¼šTutorial â†’ Resource â†’ Quiz
    tutorial = await generate_tutorial(concept)
    resource = await generate_resource(concept)
    quiz = await generate_quiz(concept)
    
    # ç«‹å³å†™å…¥æ•°æ®åº“
    await save_to_database(tutorial, resource, quiz)
```

---

## å®é™…å¹¶å‘è®¡ç®—

### åœºæ™¯ï¼š8 ä¸ªç”¨æˆ·åŒæ—¶ç”Ÿæˆè·¯çº¿å›¾

å‡è®¾ï¼š
- Celery å¹¶å‘æ•°ï¼š`--concurrency=8`
- æ¯ä¸ªè·¯çº¿å›¾æœ‰ 30 ä¸ª Concept

**Celery ä»»åŠ¡å±‚**ï¼š
```
Worker 1 â†’ è·¯çº¿å›¾ Aï¼ˆ30 ä¸ª Conceptï¼‰
Worker 2 â†’ è·¯çº¿å›¾ Bï¼ˆ25 ä¸ª Conceptï¼‰
Worker 3 â†’ è·¯çº¿å›¾ Cï¼ˆ28 ä¸ª Conceptï¼‰
Worker 4 â†’ è·¯çº¿å›¾ Dï¼ˆ32 ä¸ª Conceptï¼‰
Worker 5 â†’ è·¯çº¿å›¾ Eï¼ˆ27 ä¸ª Conceptï¼‰
Worker 6 â†’ è·¯çº¿å›¾ Fï¼ˆ30 ä¸ª Conceptï¼‰
Worker 7 â†’ è·¯çº¿å›¾ Gï¼ˆ29 ä¸ª Conceptï¼‰
Worker 8 â†’ è·¯çº¿å›¾ Hï¼ˆ26 ä¸ª Conceptï¼‰
```

**AsyncIO åç¨‹å±‚**ï¼š
```
æ€»åç¨‹æ•° = 30 + 25 + 28 + 32 + 27 + 30 + 29 + 26 = 227 ä¸ª
```

**å‰ç«¯æ˜¾ç¤º**ï¼š
- å‰ç«¯é€šè¿‡ WebSocket æ¥æ”¶æ¯ä¸ª Concept çš„ç”Ÿæˆè¿›åº¦
- æ˜¾ç¤ºçš„æ˜¯ **227 ä¸ª Concept** çš„ç”ŸæˆçŠ¶æ€
- **è¿œè¶… 8 ä¸ª Celery ä»»åŠ¡æ•°**

---

## ä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡ï¼Ÿ

### âœ… ä¼˜ç‚¹ï¼šå……åˆ†åˆ©ç”¨ AsyncIO çš„ I/O å¹¶å‘

```python
# LLM è°ƒç”¨æ˜¯ I/O å¯†é›†å‹æ“ä½œ
async def generate_tutorial(concept):
    # ç­‰å¾… LLM å“åº”ï¼ˆ20-30 ç§’ï¼‰
    response = await openai.chat.completions.create(...)
    
    # åœ¨ç­‰å¾…æœŸé—´ï¼š
    # - ä¸å ç”¨ CPU
    # - ä¸å ç”¨æ•°æ®åº“è¿æ¥
    # - åªå ç”¨å°‘é‡å†…å­˜ï¼ˆåç¨‹ä¸Šä¸‹æ–‡ï¼‰
    
    return response
```

**å…³é”®æ´å¯Ÿ**ï¼š
- 227 ä¸ªåç¨‹åŒæ—¶å¯åŠ¨ï¼Œä½†**å¤§éƒ¨åˆ†æ—¶é—´éƒ½åœ¨ç­‰å¾… LLM å“åº”**
- ç­‰å¾…æœŸé—´ä¸æ¶ˆè€—ç³»ç»Ÿèµ„æº
- åªåœ¨ä¿å­˜æ•°æ®åº“æ—¶çŸ­æš‚å ç”¨è¿æ¥ï¼ˆçº¦ 0.1 ç§’ï¼‰

### ğŸ“Š èµ„æºå ç”¨åˆ†æ

| é˜¶æ®µ | å¹¶å‘æ•° | æŒç»­æ—¶é—´ | èµ„æºå ç”¨ |
|------|--------|----------|----------|
| LLM è°ƒç”¨ï¼ˆTutorialï¼‰ | 227 | 20-30 ç§’ | å†…å­˜ï¼ˆåç¨‹ä¸Šä¸‹æ–‡ï¼‰ |
| LLM è°ƒç”¨ï¼ˆResourceï¼‰ | 227 | 15-20 ç§’ | å†…å­˜ï¼ˆåç¨‹ä¸Šä¸‹æ–‡ï¼‰ |
| LLM è°ƒç”¨ï¼ˆQuizï¼‰ | 227 | 10-15 ç§’ | å†…å­˜ï¼ˆåç¨‹ä¸Šä¸‹æ–‡ï¼‰ |
| æ•°æ®åº“å†™å…¥ | 8-16* | 0.1 ç§’ | æ•°æ®åº“è¿æ¥ |

*æ•°æ®åº“å†™å…¥è™½ç„¶æœ‰ 227 ä¸ªåç¨‹ï¼Œä½†ç”±äºè¿æ¥æ± é™åˆ¶å’Œå†™å…¥é€Ÿåº¦ï¼Œå®é™…å¹¶å‘çº¦ 8-16 ä¸ªã€‚

---

## Celery é¢„å–æœºåˆ¶è¯´æ˜

### é…ç½®

```python
worker_prefetch_multiplier=1
```

### è¡Œä¸º

- **é¢„å–æ•° = å¹¶å‘æ•° Ã— multiplier = 8 Ã— 1 = 8**
- æ¯ä¸ª Worker è¿›ç¨‹åªä¼šé¢„å– **1 ä¸ªä»»åŠ¡**
- åªæœ‰å½“å‰ä»»åŠ¡å®Œæˆåï¼Œæ‰ä¼šä»é˜Ÿåˆ—ä¸­è·å–ä¸‹ä¸€ä¸ªä»»åŠ¡

### ä¸ºä»€ä¹ˆè®¾ç½®ä¸º 1ï¼Ÿ

**åœºæ™¯å¯¹æ¯”**ï¼š

#### multiplier = 4ï¼ˆé»˜è®¤å€¼ï¼‰
```
é˜Ÿåˆ—ï¼š[Task1, Task2, Task3, Task4, Task5, Task6, Task7, Task8, Task9, Task10]

å¯åŠ¨æ—¶ï¼š
Worker 1 é¢„å– â†’ [Task1, Task2, Task3, Task4]
Worker 2 é¢„å– â†’ [Task5, Task6, Task7, Task8]
Worker 3 ç©ºé—² â†’ []
Worker 4 ç©ºé—² â†’ []

é—®é¢˜ï¼š
- Task1 æ‰§è¡Œæ—¶é—´ 5 åˆ†é’Ÿ
- Task2-8 å·²è¢«é¢„å–ï¼Œä½†åœ¨ç­‰å¾…
- Worker 3, 4 ç©ºé—²ï¼Œæ— æ³•å¸®å¿™
```

#### multiplier = 1ï¼ˆå½“å‰é…ç½®ï¼‰
```
é˜Ÿåˆ—ï¼š[Task1, Task2, Task3, Task4, Task5, Task6, Task7, Task8, Task9, Task10]

å¯åŠ¨æ—¶ï¼š
Worker 1 é¢„å– â†’ [Task1]
Worker 2 é¢„å– â†’ [Task2]
Worker 3 é¢„å– â†’ [Task3]
Worker 4 é¢„å– â†’ [Task4]
...
Worker 8 é¢„å– â†’ [Task8]

Task1 å®Œæˆï¼š
Worker 1 ç«‹å³é¢„å– â†’ [Task9]

ä¼˜ç‚¹ï¼š
- è´Ÿè½½å‡è¡¡æ›´å¥½
- å¿«ä»»åŠ¡ä¸è¢«æ…¢ä»»åŠ¡é˜»å¡
- èµ„æºåˆ©ç”¨ç‡æ›´é«˜
```

---

## å‰ç«¯æ˜¾ç¤ºè¶…è¿‡ 8 ä¸ªçš„åŸå› 

### æ•°æ®æµ

```mermaid
graph LR
    A[Celery Task 1<br/>30 Concepts] --> B[WebSocket Event]
    C[Celery Task 2<br/>25 Concepts] --> B
    D[Celery Task 3<br/>28 Concepts] --> B
    E[Celery Task ...] --> B
    F[Celery Task 8<br/>26 Concepts] --> B
    
    B --> G[Frontend<br/>æ˜¾ç¤º 227 ä¸ªè¿›åº¦æ¡]
```

### WebSocket äº‹ä»¶

æ¯ä¸ª Concept ç”Ÿæˆæ—¶ä¼šå‘é€ WebSocket äº‹ä»¶ï¼š

```python
# concept_generator.py
async def generate_single_concept(task_id, concept, ...):
    # å‘é€ WebSocket äº‹ä»¶ï¼šConcept å¼€å§‹ç”Ÿæˆ
    await notification_service.publish_content_generation_progress(
        task_id=task_id,
        concept_id=concept.concept_id,
        status="generating",
        progress_current=1,
        progress_total=total_concepts,
    )
    
    # ç”Ÿæˆå†…å®¹...
    tutorial = await generate_tutorial(concept)
    resource = await generate_resource(concept)
    quiz = await generate_quiz(concept)
    
    # å‘é€ WebSocket äº‹ä»¶ï¼šConcept å®Œæˆ
    await notification_service.publish_content_generation_progress(
        task_id=task_id,
        concept_id=concept.concept_id,
        status="completed",
        progress_current=current,
        progress_total=total_concepts,
    )
```

### å‰ç«¯æ˜¾ç¤ºé€»è¾‘

```typescript
// å‰ç«¯æ¥æ”¶ WebSocket äº‹ä»¶
websocket.on('content_generation_progress', (event) => {
  const { task_id, concept_id, status, progress_current, progress_total } = event;
  
  // æ›´æ–° UIï¼šæ˜¾ç¤ºæ¯ä¸ª Concept çš„ç”ŸæˆçŠ¶æ€
  updateConceptProgress(concept_id, status, progress_current, progress_total);
  
  // å¦‚æœæœ‰ 227 ä¸ª Concept æ­£åœ¨ç”Ÿæˆï¼Œå°±ä¼šæ˜¾ç¤º 227 ä¸ªè¿›åº¦æ¡
});
```

**ç»“è®º**ï¼šå‰ç«¯æ˜¾ç¤ºçš„æ˜¯ **Concept çº§åˆ«**çš„è¿›åº¦ï¼Œè€Œä¸æ˜¯ **Celery ä»»åŠ¡çº§åˆ«**çš„è¿›åº¦ã€‚

---

## ç³»ç»Ÿèµ„æºå®é™…å ç”¨

### 1. Celery Worker è¿›ç¨‹

```bash
$ ps aux | grep celery

USER   PID  %CPU %MEM
root   123   2.5  1.2  celery worker[1] (Task A: 30 concepts)
root   124   2.8  1.3  celery worker[2] (Task B: 25 concepts)
root   125   2.3  1.1  celery worker[3] (Task C: 28 concepts)
...
root   130   2.6  1.2  celery worker[8] (Task H: 26 concepts)

æ€»è®¡ï¼š8 ä¸ªè¿›ç¨‹
```

### 2. AsyncIO åç¨‹

```python
# æ¯ä¸ª Celery Worker è¿›ç¨‹å†…éƒ¨è¿è¡Œå¤šä¸ªåç¨‹
Worker 1: 30 ä¸ªåç¨‹ï¼ˆè½»é‡çº§ï¼Œå…±äº«äº‹ä»¶å¾ªç¯ï¼‰
Worker 2: 25 ä¸ªåç¨‹
...
Worker 8: 26 ä¸ªåç¨‹

æ€»è®¡ï¼š227 ä¸ªåç¨‹
å†…å­˜å ç”¨ï¼šæ¯ä¸ªåç¨‹çº¦ 10KBï¼Œæ€»è®¡çº¦ 2.27MB
```

### 3. æ•°æ®åº“è¿æ¥

```python
# è¿æ¥æ± é…ç½®
pool_size = 10
max_overflow = 20
å®é™…å¹¶å‘è¿æ¥ â‰ˆ 8-16 ä¸ªï¼ˆå› ä¸ºå†™å…¥æ˜¯ç¬æ—¶çš„ï¼‰
```

---

## å†å²æ¼”è¿›

### æ—§æ¶æ„ï¼ˆå·²åºŸå¼ƒï¼‰ï¼šåŒé‡å¹¶å‘æ§åˆ¶

```python
# Semaphore é™åˆ¶ Concept å¹¶å‘
semaphore = asyncio.Semaphore(5)  # æ¯ä¸ªä»»åŠ¡æœ€å¤š 5 ä¸ª Concept å¹¶å‘

async def _generate_content_parallel(concepts, ...):
    tasks = [
        _generate_with_semaphore(semaphore, concept)
        for concept in concepts
    ]
    await asyncio.gather(*tasks)

async def _generate_with_semaphore(semaphore, concept):
    async with semaphore:
        # åŒæ—¶æœ€å¤š 5 ä¸ª Concept åœ¨ç”Ÿæˆ
        await generate_single_concept(concept)
```

**é—®é¢˜**ï¼š
- å¤æ‚åº¦é«˜ï¼šCelery + Semaphore åŒé‡æ§åˆ¶
- èµ„æºæµªè´¹ï¼šSemaphore é™åˆ¶äº† AsyncIO çš„ I/O å¹¶å‘èƒ½åŠ›
- éš¾ä»¥è°ƒä¼˜ï¼šéœ€è¦åŒæ—¶è°ƒæ•´ `--concurrency` å’Œ `Semaphore(N)`

### æ–°æ¶æ„ï¼ˆå½“å‰ï¼‰ï¼šå•å±‚å¹¶å‘æ§åˆ¶

```python
# ç§»é™¤ Semaphoreï¼Œç›´æ¥å¹¶å‘æ‰€æœ‰ Concept
async def _generate_content_parallel(concepts, ...):
    tasks = [
        generate_single_concept(concept)
        for concept in concepts
    ]
    # æ— é™åˆ¶å¹¶å‘ï¼ˆä¾èµ– AsyncIO çš„ I/O ç‰¹æ€§ï¼‰
    await asyncio.gather(*tasks, return_exceptions=True)
```

**ä¼˜ç‚¹**ï¼š
- ç®€å•ï¼šåªéœ€è°ƒæ•´ Celery `--concurrency`
- é«˜æ•ˆï¼šå……åˆ†åˆ©ç”¨ AsyncIO çš„ I/O å¹¶å‘
- å¯æ§ï¼šæ•°æ®åº“è¿æ¥æ± è‡ªç„¶é™åˆ¶å®é™…å¹¶å‘

---

## è°ƒä¼˜å»ºè®®

### 1. å¦‚æœæƒ³å‡å°‘å‰ç«¯æ˜¾ç¤ºçš„å¹¶å‘æ•°

**é€‰é¡¹ Aï¼šæ·»åŠ  Semaphoreï¼ˆä¸æ¨èï¼‰**

```python
# é™åˆ¶æ¯ä¸ªè·¯çº¿å›¾å†…çš„ Concept å¹¶å‘æ•°
semaphore = asyncio.Semaphore(5)

async def _generate_content_parallel(concepts, ...):
    tasks = [
        _generate_with_limit(semaphore, concept)
        for concept in concepts
    ]
    await asyncio.gather(*tasks)
```

**ç¼ºç‚¹**ï¼š
- é™ä½ I/O å¹¶å‘æ•ˆç‡
- å¢åŠ ä»£ç å¤æ‚åº¦
- ç‰ºç‰²å¼‚æ­¥ä¼˜åŠ¿

**é€‰é¡¹ Bï¼šè°ƒæ•´å‰ç«¯æ˜¾ç¤ºï¼ˆæ¨èï¼‰**

```typescript
// å‰ç«¯åªæ˜¾ç¤ºè·¯çº¿å›¾çº§åˆ«çš„è¿›åº¦ï¼Œä¸æ˜¾ç¤ºæ¯ä¸ª Concept
<ProgressBar 
  label="Generating content..." 
  current={completedConcepts} 
  total={totalConcepts}
/>

// è€Œä¸æ˜¯ï¼š
{concepts.map(concept => (
  <ConceptProgressBar key={concept.id} concept={concept} />
))}
```

### 2. å¦‚æœæƒ³å‡å°‘æ•°æ®åº“å‹åŠ›

**è°ƒæ•´ Celery å¹¶å‘æ•°**ï¼ˆæ¨èï¼‰ï¼š

```bash
# ä» 8 é™ä½åˆ° 4
celery -A app.core.celery_app worker \
  --queues=content_generation \
  --concurrency=4
```

**æ•ˆæœ**ï¼š
- æœ€å¤š 4 ä¸ªè·¯çº¿å›¾åŒæ—¶ç”Ÿæˆ
- å‰ç«¯æ˜¾ç¤ºæ•°é‡é™ä½åˆ°çº¦ 120 ä¸ªï¼ˆ4 Ã— 30ï¼‰
- æ•°æ®åº“è¿æ¥å‹åŠ›å‡åŠ

---

## ç›‘æ§æŒ‡æ ‡

### 1. æŸ¥çœ‹å½“å‰ Celery æ´»è·ƒä»»åŠ¡

```bash
celery -A app.core.celery_app inspect active

# åº”è¯¥çœ‹åˆ°æœ€å¤š 8 ä¸ªä»»åŠ¡
[
  {
    "id": "task-1",
    "name": "generate_roadmap_content",
    "args": ["roadmap-a", ...]
  },
  ...
]
```

### 2. æŸ¥çœ‹æ•°æ®åº“è¿æ¥æ•°

```sql
SELECT 
  count(*) as total_connections,
  count(*) FILTER (WHERE state = 'active') as active_connections
FROM pg_stat_activity;

-- æœŸæœ›å€¼ï¼š
-- total_connections: 10-20
-- active_connections: 5-15
```

### 3. å‰ç«¯ WebSocket äº‹ä»¶æµ

```javascript
// ç»Ÿè®¡æ¯ç§’æ”¶åˆ°çš„äº‹ä»¶æ•°
let eventCount = 0;
setInterval(() => {
  console.log(`WebSocket events/sec: ${eventCount}`);
  eventCount = 0;
}, 1000);

websocket.on('content_generation_progress', () => {
  eventCount++;
});

// æœŸæœ›å€¼ï¼š
// é«˜å³°æœŸï¼š50-100 events/sec
// å¹³ç¨³æœŸï¼š10-30 events/sec
```

---

## æ€»ç»“

### é—®é¢˜ç­”æ¡ˆ

**Qï¼šå‰ç«¯æ˜¾ç¤ºè¶…è¿‡ 8 ä¸ªï¼Œæ˜¯ Celery é¢„å–å—ï¼Ÿ**

**Aï¼šä¸æ˜¯ã€‚**

- âœ… Celery é…ç½®ï¼š`worker_prefetch_multiplier=1`ï¼ˆæ— å¤šä½™é¢„å–ï¼‰
- âœ… Celery å¹¶å‘ï¼š8 ä¸ªä»»åŠ¡ï¼ˆ8 ä¸ªè·¯çº¿å›¾ï¼‰
- âœ… AsyncIO å¹¶å‘ï¼šæ¯ä¸ªè·¯çº¿å›¾å†…æ‰€æœ‰ Concept å¹¶å‘ï¼ˆ30 Ã— 8 = 240 ä¸ªï¼‰
- âœ… å‰ç«¯æ˜¾ç¤ºï¼šConcept çº§åˆ«çš„è¿›åº¦ï¼ˆ240 ä¸ªè¿›åº¦æ¡ï¼‰

### å…³é”®è®¾è®¡æ€æƒ³

**ä¸¤å±‚å¹¶å‘æ¶æ„**ï¼š
1. **Celery å±‚**ï¼šæ§åˆ¶è·¯çº¿å›¾çº§åˆ«çš„å¹¶å‘ï¼ˆCPU/å†…å­˜é™åˆ¶ï¼‰
2. **AsyncIO å±‚**ï¼šåˆ©ç”¨ I/O ç‰¹æ€§å¹¶å‘æ‰€æœ‰ Conceptï¼ˆç­‰å¾…æ—¶ä¸å èµ„æºï¼‰

**ä¸ºä»€ä¹ˆæœ‰æ•ˆ**ï¼š
- LLM è°ƒç”¨æ˜¯ I/O å¯†é›†å‹ï¼ˆ99% æ—¶é—´åœ¨ç­‰å¾…ï¼‰
- ç­‰å¾…æœŸé—´ä¸å ç”¨ CPUã€æ•°æ®åº“ã€å†…å­˜
- åªåœ¨æ•°æ®åº“å†™å…¥æ—¶çŸ­æš‚å ç”¨è¿æ¥ï¼ˆ0.1 ç§’ï¼‰
- è¿æ¥æ± è‡ªç„¶é™åˆ¶å®é™…å¹¶å‘æ•°

### è°ƒä¼˜è·¯å¾„

å¦‚æœè§‰å¾—å‰ç«¯æ˜¾ç¤ºå¤ªå¤šï¼š
1. **å‰ç«¯ä¼˜åŒ–**ï¼šåªæ˜¾ç¤ºè·¯çº¿å›¾çº§åˆ«è¿›åº¦ï¼ˆæ¨èï¼‰
2. **åç«¯ä¼˜åŒ–**ï¼šé™ä½ Celery å¹¶å‘æ•°ï¼ˆ`--concurrency=4`ï¼‰
3. **ä¸æ¨è**ï¼šæ·»åŠ  Semaphoreï¼ˆç‰ºç‰²å¼‚æ­¥ä¼˜åŠ¿ï¼‰

---

## ç›¸å…³æ–‡æ¡£

- [å¹¶å‘æ§åˆ¶é‡æ„æ€»ç»“](../CONCURRENT_REFACTOR_SUMMARY.md)
- [å¹¶å‘ä¼˜åŒ–æ–¹æ¡ˆ](../CONCURRENT_OPTIMIZATION_PLAN.md)
- [Celery Worker æŒ‡å—](../CELERY_WORKER_GUIDE.md)

